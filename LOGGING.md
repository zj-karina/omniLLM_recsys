# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏.

## –§–∞–π–ª–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –ª–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª `logs/training.log` (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏).

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞

–í —Ñ–∞–π–ª–µ `configs/sft/fashion_multitask.yaml`:

```yaml
# Logging
log_file: "logs/training.log"  # –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –ª–æ–≥–æ–≤
logging_steps: 10              # –ß–∞—Å—Ç–æ—Ç–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–∫–∞–∂–¥—ã–µ 10 —à–∞–≥–æ–≤)
```

## Weights & Biases (W&B)

–î–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ–±—É—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Weights & Biases.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:**
   ```bash
   make setup-wandb
   ```

2. **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ - —Ä—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:**
   ```bash
   pip install wandb
   wandb login
   ```

3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
   ```yaml
   report_to: "wandb"
   run_name: "fashion_multitask_training"
   ```

### –ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è

- **–ú–µ—Ç—Ä–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è:**
  - `train/loss` - –ø–æ—Ç–µ—Ä—è –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ
  - `train/learning_rate` - —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è
  - `train/global_step` - –Ω–æ–º–µ—Ä —à–∞–≥–∞
  - `train/epoch` - –Ω–æ–º–µ—Ä —ç–ø–æ—Ö–∏

- **–ú–µ—Ç—Ä–∏–∫–∏ —ç–ø–æ—Ö:**
  - `train/epoch_loss` - —Å—Ä–µ–¥–Ω—è—è –ø–æ—Ç–µ—Ä—è –∑–∞ —ç–ø–æ—Ö—É
  - `train/epoch` - –Ω–æ–º–µ—Ä —ç–ø–æ—Ö–∏

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

1. **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:** https://wandb.ai/
2. **–§–∞–π–ª–æ–≤—ã–µ –ª–æ–≥–∏:** `logs/training.log`

## –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

–ú–æ–¥–µ–ª—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞

```yaml
save_steps: 100        # –°–æ—Ö—Ä–∞–Ω—è—Ç—å –∫–∞–∂–¥—ã–µ 100 —à–∞–≥–æ–≤
save_total_limit: 3    # –•—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ 3 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —á–µ–∫–ø–æ–∏–Ω—Ç–∞
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —á–µ–∫–ø–æ–∏–Ω—Ç–æ–≤

```
output/fashion_multitask_model/
‚îú‚îÄ‚îÄ checkpoint-100/
‚îÇ   ‚îú‚îÄ‚îÄ model.pt           # –í–µ—Å–∞ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ optimizer.pt       # –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ training_state.pt  # –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ tokenizer/         # –¢–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä
‚îú‚îÄ‚îÄ checkpoint-200/
‚îî‚îÄ‚îÄ ...
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥

```
Epoch 1/3, Step 100, Loss: 2.3456
üíæ Checkpoint saved at step 100
Epoch 1/3, Step 200, Loss: 2.1234
üíæ Checkpoint saved at step 200
```

### –§–∞–π–ª–æ–≤—ã–µ –ª–æ–≥–∏

```
2024-01-15 10:30:15 - INFO - Epoch 1/3, Step 100, Loss: 2.3456
2024-01-15 10:30:20 - INFO - üíæ Checkpoint saved at step 100
```

## –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### –û—Ç–∫–ª—é—á–∏—Ç—å W&B

```yaml
report_to: "none"
```

### –û—Ç–∫–ª—é—á–∏—Ç—å —Ñ–∞–π–ª–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```yaml
log_file: null
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### W&B –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –∑–∞–ª–æ–≥–∏–Ω–µ–Ω—ã: `wandb login`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á: `echo $WANDB_API_KEY`

### –§–∞–π–ª—ã –ª–æ–≥–æ–≤ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `logs/` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

### –ß–µ–∫–ø–æ–∏–Ω—Ç—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `output_dir` –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∑–∞–ø–∏—Å–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `save_steps > 0`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ–±—É—á–µ–Ω–∏—è —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

```bash
# 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞
make install
make setup-wandb

# 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
python prepare_fashion_multitask.py --max_items 1000

# 3. –û–±—É—á–µ–Ω–∏–µ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
python train_fashion.py
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# –§–∞–π–ª–æ–≤—ã–µ –ª–æ–≥–∏
tail -f logs/training.log

# W&B –≤ –±—Ä–∞—É–∑–µ—Ä–µ
# –û—Ç–∫—Ä–æ–π—Ç–µ https://wandb.ai/ –∏ –Ω–∞–π–¥–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ —á–µ–∫–ø–æ–∏–Ω—Ç–∞

```python
# –ó–∞–≥—Ä—É–∑–∫–∞ —á–µ–∫–ø–æ–∏–Ω—Ç–∞
checkpoint_path = "output/fashion_multitask_model/checkpoint-1000"
model.load_state_dict(torch.load(f"{checkpoint_path}/model.pt"))
```







