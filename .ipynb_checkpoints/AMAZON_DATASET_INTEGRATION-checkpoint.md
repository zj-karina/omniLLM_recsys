# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Amazon Fashion 2023 Dataset

## üéâ –ß—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ

### 1. –ù–æ–≤—ã–π –¥–∞—Ç–∞—Å–µ—Ç
- **–ò—Å—Ç–æ—á–Ω–∏–∫**: [Amazon Fashion 2023 Full](https://huggingface.co/datasets/seniichev/amazon-fashion-2023-full) –Ω–∞ Hugging Face
- **–†–∞–∑–º–µ—Ä**: 2,194,432 –∑–∞–ø–∏—Å–µ–π
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏**: 259,402 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–¢–æ–≤–∞—Ä—ã**: 709,036 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
- **–ü—Ä–∏–º–µ—Ä—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è**: 295,688

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- **recommendation_experiment.yaml** - –±–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å –Ω–æ–≤—ã–º –¥–∞—Ç–∞—Å–µ—Ç–æ–º
- **semantic_recommendation_experiment.yaml** - semantic –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å –Ω–æ–≤—ã–º –¥–∞—Ç–∞—Å–µ—Ç–æ–º
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Å–ª–æ–≤–∞—Ä—è (709,036 —Ç–æ–≤–∞—Ä–æ–≤)

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- **prepare_recommendation_data()** - —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Hugging Face –¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ item mapping –∏–∑ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–π –ø–æ–∫—É–ø–æ–∫
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ timestamp –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞

### 4. –ù–æ–≤—ã–µ –ø–æ–ª—è –¥–∞–Ω–Ω—ã—Ö
```python
# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø–∏—Å–∏:
{
    'user_id': 'AGBFYI2DDIKXC5Y4FARTYDTQBMFQ',
    'parent_asin': 'B00LOPVX74',  # ID —Ç–æ–≤–∞—Ä–∞
    'title': 'CHUVORA 925 Sterling Silver...',  # –ù–∞–∑–≤–∞–Ω–∏–µ
    'rating': 5.0,  # –†–µ–π—Ç–∏–Ω–≥
    'timestamp': 1578528394489,  # –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞
    'features': [...],  # –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ç–æ–≤–∞—Ä–∞
    'text': 'I think this locket is really pretty...',  # –û—Ç–∑—ã–≤
    'images': [...]  # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
}
```

### 5. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **test_amazon_dataset.py** - —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞
- **make test-amazon-dataset** - –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞
```bash
make test-amazon-dataset
```

### 2. –ó–∞–ø—É—Å–∫ –±–∞–∑–æ–≤–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞
```bash
make train-recommendation
```

### 3. –ó–∞–ø—É—Å–∫ semantic —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞
```bash
make train-semantic-recommendation
```

### 4. –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```python
from any2any_trainer.data.recommendation_dataset import prepare_recommendation_data

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞
train_df, val_df, test_df, item2index = prepare_recommendation_data(
    dataset_name="seniichev/amazon-fashion-2023-full",
    user_id_field="user_id",
    item_id_field="parent_asin",
    title_field="title",
    max_history_length=10,
    min_history_length=2
)
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

### –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π**: 2,194,432
- **–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –Ω–∞–±–æ—Ä**: 2,194,432 –∑–∞–ø–∏—Å–µ–π
- **–í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä**: 196,843 –∑–∞–ø–∏—Å–µ–π  
- **–¢–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä**: 109,664 –∑–∞–ø–∏—Å–µ–π

### –ü–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**: 259,402
- **–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤**: 709,036
- **–ü—Ä–∏–º–µ—Ä–æ–≤ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è**: 295,688
- **–°—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ –∏—Å—Ç–æ—Ä–∏–∏**: ~4.2 —Ç–æ–≤–∞—Ä–∞ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ä–µ–π—Ç–∏–Ω–≥–∞–º
- **5 –∑–≤–µ–∑–¥**: ~60% –∑–∞–ø–∏—Å–µ–π
- **4 –∑–≤–µ–∑–¥—ã**: ~25% –∑–∞–ø–∏—Å–µ–π
- **3 –∑–≤–µ–∑–¥—ã**: ~10% –∑–∞–ø–∏—Å–µ–π
- **2 –∑–≤–µ–∑–¥—ã**: ~3% –∑–∞–ø–∏—Å–µ–π
- **1 –∑–≤–µ–∑–¥–∞**: ~2% –∑–∞–ø–∏—Å–µ–π

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–∞—Ç–∞—Å–µ—Ç–∞
```yaml
# –í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
dataset_name: "seniichev/amazon-fashion-2023-full"
user_id_field: "user_id"
item_id_field: "parent_asin"
title_field: "title"
max_history_length: 10
min_history_length: 2
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏
```yaml
# –†–∞–∑–º–µ—Ä —Å–ª–æ–≤–∞—Ä—è –æ–±–Ω–æ–≤–ª–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
id_vocab_size: 709036  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
id_dim: 512            # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤
fusion_dim: 1024       # –°–∫—Ä—ã—Ç–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å fusion head
reduced_dim: 1024      # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
```

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞

### 1. –ë–æ–ª—å—à–∏–π —Ä–∞–∑–º–µ—Ä
- –í 10+ —Ä–∞–∑ –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö —á–µ–º –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞—Ö
- –ë–æ–ª–µ–µ —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ —Ç–æ–≤–∞—Ä—ã
- –õ—É—á—à–∞—è —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å

### 2. –ë–æ–≥–∞—Ç—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
- –ù–∞–∑–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ
- –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤
- –¢–µ–∫—Å—Ç—ã –æ—Ç–∑—ã–≤–æ–≤

### 3. –í—Ä–µ–º–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- Timestamp –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

### 4. –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- –î–æ—Å—Ç—É–ø–µ–Ω —á–µ—Ä–µ–∑ Hugging Face
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

## üìö –°—Å—ã–ª–∫–∏

- [Amazon Fashion 2023 Full Dataset](https://huggingface.co/datasets/seniichev/amazon-fashion-2023-full)
- [Hugging Face Datasets Library](https://huggingface.co/docs/datasets/)
- [Original Recommendation Experiments](RECOMMENDATION_EXPERIMENTS.md)


